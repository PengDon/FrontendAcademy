<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Electron打包和发布示例</title>
  <meta name="description" content="Electron应用打包和发布示例应用">
  <meta name="author" content="Electron示例应用">
  
  <!-- 安全头部 -->
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; connect-src 'self';">
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  <meta http-equiv="X-Frame-Options" content="DENY">
  <meta http-equiv="X-XSS-Protection" content="1; mode=block">
  
  <style>
    /* 基础样式 */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      color: #333;
      background-color: #f5f5f5;
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    
    /* 容器样式 */
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    
    /* 头部样式 */
    header {
      background-color: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      margin-bottom: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    header h1 {
      font-size: 24px;
      font-weight: 600;
      color: #2c3e50;
    }
    
    .app-info {
      font-size: 14px;
      color: #7f8c8d;
    }
    
    /* 导航样式 */
    nav {
      background-color: #fff;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    
    .nav-tabs {
      display: flex;
      gap: 10px;
      list-style: none;
    }
    
    .nav-item {
      padding: 8px 16px;
      cursor: pointer;
      border-radius: 4px;
      transition: all 0.3s ease;
      font-weight: 500;
    }
    
    .nav-item.active {
      background-color: #3498db;
      color: white;
    }
    
    .nav-item:not(.active):hover {
      background-color: #ecf0f1;
    }
    
    /* 内容区域 */
    .content {
      background-color: #fff;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }
    
    /* 卡片样式 */
    .card {
      background-color: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      padding: 20px;
      margin-bottom: 20px;
    }
    
    .card h3 {
      margin-bottom: 15px;
      color: #2c3e50;
      font-size: 18px;
    }
    
    /* 按钮样式 */
    .btn {
      display: inline-block;
      padding: 10px 20px;
      background-color: #3498db;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: background-color 0.3s ease;
      margin-right: 10px;
      margin-bottom: 10px;
    }
    
    .btn:hover {
      background-color: #2980b9;
    }
    
    .btn-secondary {
      background-color: #95a5a6;
    }
    
    .btn-secondary:hover {
      background-color: #7f8c8d;
    }
    
    .btn-success {
      background-color: #27ae60;
    }
    
    .btn-success:hover {
      background-color: #229954;
    }
    
    .btn-danger {
      background-color: #e74c3c;
    }
    
    .btn-danger:hover {
      background-color: #c0392b;
    }
    
    .btn-sm {
      padding: 6px 12px;
      font-size: 12px;
    }
    
    .btn-lg {
      padding: 12px 24px;
      font-size: 16px;
    }
    
    /* 表单样式 */
    .form-group {
      margin-bottom: 20px;
    }
    
    label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
      color: #2c3e50;
    }
    
    input[type="text"],
    input[type="email"],
    input[type="password"],
    select,
    textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 14px;
      transition: border-color 0.3s ease;
    }
    
    input[type="text"]:focus,
    input[type="email"]:focus,
    input[type="password"]:focus,
    select:focus,
    textarea:focus {
      outline: none;
      border-color: #3498db;
    }
    
    /* 表格样式 */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }
    
    th,
    td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid #ddd;
    }
    
    th {
      background-color: #f8f9fa;
      font-weight: 600;
      color: #2c3e50;
    }
    
    tr:hover {
      background-color: #f8f9fa;
    }
    
    /* 列表样式 */
    ul, ol {
      padding-left: 20px;
      margin-bottom: 20px;
    }
    
    li {
      margin-bottom: 8px;
    }
    
    /* 代码块样式 */
    pre {
      background-color: #f8f9fa;
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
      margin-bottom: 20px;
      font-family: 'Courier New', Courier, monospace;
      font-size: 13px;
      line-height: 1.5;
    }
    
    code {
      background-color: #f1f1f1;
      padding: 2px 4px;
      border-radius: 3px;
      font-family: 'Courier New', Courier, monospace;
      font-size: 14px;
    }
    
    /* 进度条样式 */
    .progress {
      width: 100%;
      height: 20px;
      background-color: #ecf0f1;
      border-radius: 10px;
      overflow: hidden;
      margin-bottom: 20px;
    }
    
    .progress-bar {
      height: 100%;
      background-color: #3498db;
      border-radius: 10px;
      transition: width 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 12px;
      font-weight: 500;
    }
    
    /* 状态标签 */
    .badge {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 500;
    }
    
    .badge-success {
      background-color: #2ecc71;
      color: white;
    }
    
    .badge-warning {
      background-color: #f39c12;
      color: white;
    }
    
    .badge-danger {
      background-color: #e74c3c;
      color: white;
    }
    
    .badge-info {
      background-color: #3498db;
      color: white;
    }
    
    /* 消息框样式 */
    .alert {
      padding: 15px;
      border-radius: 4px;
      margin-bottom: 20px;
    }
    
    .alert-success {
      background-color: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    
    .alert-danger {
      background-color: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
    
    .alert-warning {
      background-color: #fff3cd;
      color: #856404;
      border: 1px solid #ffeaa7;
    }
    
    .alert-info {
      background-color: #d1ecf1;
      color: #0c5460;
      border: 1px solid #bee5eb;
    }
    
    /* 页脚样式 */
    footer {
      text-align: center;
      padding: 20px;
      color: #7f8c8d;
      font-size: 14px;
      border-top: 1px solid #eee;
      margin-top: 40px;
    }
    
    /* 响应式设计 */
    @media (max-width: 768px) {
      .container {
        padding: 10px;
      }
      
      .nav-tabs {
        flex-wrap: wrap;
      }
      
      .btn {
        width: 100%;
        margin-right: 0;
      }
    }
    
    /* 加载动画 */
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid #f3f3f3;
      border-top: 3px solid #3498db;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* 自定义窗口控制按钮（用于Mac隐藏式标题栏） */
    .window-controls {
      display: flex;
      gap: 8px;
    }
    
    .window-btn {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      cursor: pointer;
    }
    
    .window-btn.close {
      background-color: #ff5f56;
    }
    
    .window-btn.minimize {
      background-color: #ffbd2e;
    }
    
    .window-btn.maximize {
      background-color: #27c93f;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- 应用头部 -->
    <header>
      <div>
        <h1>Electron打包和发布示例</h1>
        <div class="app-info">
          <span id="app-version">版本: 加载中...</span>
          <span id="electron-version"> | Electron: 加载中...</span>
        </div>
      </div>
      
      <!-- 窗口控制按钮 (仅在特定平台显示) -->
      <div id="window-controls" class="window-controls">
        <div class="window-btn minimize" onclick="windowControls('minimize')"></div>
        <div class="window-btn maximize" onclick="windowControls('maximize')"></div>
        <div class="window-btn close" onclick="windowControls('close')"></div>
      </div>
    </header>
    
    <!-- 导航标签 -->
    <nav>
      <ul class="nav-tabs">
        <li class="nav-item active" onclick="switchTab('home')">首页</li>
        <li class="nav-item" onclick="switchTab('packaging')">打包配置</li>
        <li class="nav-item" onclick="switchTab('updates')">自动更新</li>
        <li class="nav-item" onclick="switchTab('platforms')">平台支持</li>
        <li class="nav-item" onclick="switchTab('security')">安全设置</li>
        <li class="nav-item" onclick="switchTab('about')">关于</li>
      </ul>
    </nav>
    
    <!-- 主要内容区域 -->
    <div class="content">
      <!-- 首页标签内容 -->
      <div id="home" class="tab-content active">
        <div class="card">
          <h3>Electron打包示例</h3>
          <p>这是一个演示Electron应用打包和发布功能的示例应用。通过此示例，您可以了解：</p>
          <ul>
            <li>使用electron-builder进行应用打包</li>
            <li>支持Windows、macOS和Linux多平台构建</li>
            <li>配置自动更新功能</li>
            <li>实现代码签名</li>
            <li>设置CI/CD流程</li>
          </ul>
          
          <div style="margin-top: 20px;">
            <button class="btn" onclick="checkForUpdates()">检查更新</button>
            <button class="btn btn-secondary" onclick="showNotification()">发送通知</button>
            <button class="btn btn-info" onclick="showAppInfo()">显示应用信息</button>
          </div>
        </div>
        
        <div class="card">
          <h3>快速开始</h3>
          <p>要开始使用此示例应用，请按照以下步骤操作：</p>
          
          <h4>安装依赖</h4>
          <pre>npm install</pre>
          
          <h4>开发模式运行</h4>
          <pre>npm run dev</pre>
          
          <h4>打包应用</h4>
          <pre>npm run build</pre>
          
          <h4>特定平台打包</h4>
          <pre>npm run build:win    # Windows打包
npm run build:mac    # macOS打包
npm run build:linux  # Linux打包</pre>
        </div>
      </div>
      
      <!-- 打包配置标签内容 -->
      <div id="packaging" class="tab-content">
        <div class="card">
          <h3>打包配置说明</h3>
          <p>本示例使用electron-builder进行应用打包，支持以下配置：</p>
          
          <h4>主要配置文件</h4>
          <ul>
            <li><code>electron-builder-config.js</code> - 详细的打包配置</li>
            <li><code>package.json</code> - 项目依赖和构建脚本</li>
          </ul>
          
          <h4>打包功能</h4>
          <ul>
            <li>多平台支持（Windows、macOS、Linux）</li>
            <li>多格式输出（安装包、便携版、压缩包等）</li>
            <li>自定义图标和资源</li>
            <li>文件关联设置</li>
            <li>代码签名配置</li>
            <li>自动更新集成</li>
          </ul>
          
          <button class="btn" onclick="openConfigDir()">打开配置目录</button>
        </div>
        
        <div class="card">
          <h3>构建参数</h3>
          <table>
            <thead>
              <tr>
                <th>参数</th>
                <th>描述</th>
                <th>示例值</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>NODE_ENV</td>
                <td>环境模式</td>
                <td>production / development</td>
              </tr>
              <tr>
                <td>TARGET_PLATFORM</td>
                <td>目标平台</td>
                <td>win / mac / linux / all</td>
              </tr>
              <tr>
                <td>UPDATE_SERVER_URL</td>
                <td>更新服务器URL</td>
                <td>https://example.com/updates</td>
              </tr>
              <tr>
                <td>APPLE_ID</td>
                <td>Apple开发者ID</td>
                <td>your-email@example.com</td>
              </tr>
              <tr>
                <td>GITHUB_TOKEN</td>
                <td>GitHub API令牌</td>
                <td>ghp_xxxxxxxxxxxx</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      
      <!-- 自动更新标签内容 -->
      <div id="updates" class="tab-content">
        <div class="card">
          <h3>自动更新功能</h3>
          <p>本示例集成了electron-updater库，提供自动更新功能。</p>
          
          <div style="margin-bottom: 20px;">
            <button class="btn" onclick="checkForUpdates()">立即检查更新</button>
            <span id="update-status" style="margin-left: 15px;">等待检查...</span>
          </div>
          
          <div id="update-progress-container" style="display: none;">
            <h4>下载进度</h4>
            <div class="progress">
              <div id="update-progress-bar" class="progress-bar" style="width: 0%;">0%</div>
            </div>
          </div>
          
          <h4>更新功能特性</h4>
          <ul>
            <li>自动检查更新（应用启动时）</li>
            <li>手动检查更新</li>
            <li>下载进度显示</li>
            <li>更新完成后的重启提示</li>
            <li>支持不同的发布渠道</li>
          </ul>
          
          <h4>更新配置</h4>
          <p>更新服务器配置可以通过环境变量或配置文件设置：</p>
          <pre>UPDATE_SERVER_URL=https://example.com/updates
UPDATE_CHANNEL=stable</pre>
        </div>
      </div>
      
      <!-- 平台支持标签内容 -->
      <div id="platforms" class="tab-content">
        <div class="card">
          <h3>平台支持</h3>
          
          <div style="display: flex; flex-wrap: wrap; gap: 20px; margin-bottom: 20px;">
            <!-- Windows支持 -->
            <div style="flex: 1; min-width: 250px; border: 1px solid #ddd; border-radius: 8px; padding: 15px;">
              <h4>Windows</h4>
              <p><span class="badge badge-success">支持</span></p>
              <ul>
                <li>NSIS安装包 (.exe)</li>
                <li>便携版 (.exe)</li>
                <li>ZIP压缩包</li>
                <li>支持x64、x86和ARM64架构</li>
                <li>代码签名支持</li>
              </ul>
              <button class="btn btn-sm" onclick="buildForWindows()">构建Windows版本</button>
            </div>
            
            <!-- macOS支持 -->
            <div style="flex: 1; min-width: 250px; border: 1px solid #ddd; border-radius: 8px; padding: 15px;">
              <h4>macOS</h4>
              <p><span class="badge badge-success">支持</span></p>
              <ul>
                <li>DMG安装包</li>
                <li>PKG安装包</li>
                <li>ZIP压缩包</li>
                <li>Mac App Store版本</li>
                <li>公证和强化运行时</li>
              </ul>
              <button class="btn btn-sm" onclick="buildForMacOS()">构建macOS版本</button>
            </div>
            
            <!-- Linux支持 -->
            <div style="flex: 1; min-width: 250px; border: 1px solid #ddd; border-radius: 8px; padding: 15px;">
              <h4>Linux</h4>
              <p><span class="badge badge-success">支持</span></p>
              <ul>
                <li>AppImage</li>
                <li>DEB包</li>
                <li>RPM包</li>
                <li>Pacman包</li>
                <li>Snap包</li>
                <li>Tarball</li>
              </ul>
              <button class="btn btn-sm" onclick="buildForLinux()">构建Linux版本</button>
            </div>
          </div>
          
          <h4>跨平台注意事项</h4>
          <ul>
            <li>图标格式：Windows (.ico)、macOS (.icns)、Linux (.png)</li>
            <li>路径分隔符：使用Node.js的path模块处理</li>
            <li>系统API差异：使用条件判断处理不同平台的特定API</li>
            <li>打包环境：推荐使用各平台原生环境或CI/CD服务</li>
          </ul>
        </div>
      </div>
      
      <!-- 安全设置标签内容 -->
      <div id="security" class="tab-content">
        <div class="card">
          <h3>安全最佳实践</h3>
          
          <h4>Electron安全配置</h4>
          <ul>
            <li>启用上下文隔离</li>
            <li>禁用Node.js集成</li>
            <li>使用预加载脚本暴露API</li>
            <li>配置内容安全策略(CSP)</li>
            <li>使用https协议加载远程内容</li>
            <li>验证所有用户输入</li>
          </ul>
          
          <h4>代码签名</h4>
          <p>代码签名可以提高应用的可信度，防止未授权的修改。</p>
          
          <h5>Windows代码签名</h5>
          <pre>WINDOWS_CERTIFICATE_FILE=path/to/cert.pfx
WINDOWS_CERTIFICATE_PASSWORD=your-password</pre>
          
          <h5>macOS代码签名</h5>
          <pre>MAC_CERTIFICATE_IDENTITY="Developer ID Application: Your Name"
APPLE_ID=your-email@example.com
APPLE_TEAM_ID=YOURTEAMID</pre>
        </div>
        
        <div class="card">
          <h3>隐私保护</h3>
          <ul>
            <li>仅收集必要的用户数据</li>
            <li>提供清晰的隐私政策</li>
            <li>加密敏感数据</li>
            <li>尊重系统权限设置</li>
            <li>正确处理临时文件</li>
          </ul>
        </div>
      </div>
      
      <!-- 关于标签内容 -->
      <div id="about" class="tab-content">
        <div class="card">
          <h3>关于应用</h3>
          <p>Electron打包和发布示例应用</p>
          <p>版本: <span id="about-version">加载中...</span></p>
          <p>Electron版本: <span id="about-electron-version">加载中...</span></p>
          <p>平台: <span id="about-platform">加载中...</span></p>
          <p>架构: <span id="about-arch">加载中...</span></p>
          
          <div style="margin-top: 20px;">
            <h4>许可证</h4>
            <p>MIT License</p>
          </div>
          
          <div style="margin-top: 20px;">
            <button class="btn" onclick="viewLogs()">查看应用日志</button>
            <button class="btn btn-secondary" onclick="openExternalDocs()">查看文档</button>
          </div>
        </div>
      </div>
    </div>
    
    <!-- 页脚 -->
    <footer>
      <p>© 2023 Electron打包和发布示例应用 - 使用Electron构建</p>
    </footer>
  </div>
  
  <!-- 日志查看对话框 (默认隐藏) -->
  <div id="logs-dialog" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 80%; max-width: 800px; height: 60%; max-height: 600px; background: white; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.3); z-index: 1000; display: none;">
    <div style="padding: 20px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center;">
      <h3>应用日志</h3>
      <button class="btn btn-sm btn-danger" onclick="closeLogsDialog()">关闭</button>
    </div>
    <div style="padding: 20px; height: calc(100% - 80px); overflow: auto;">
      <pre id="logs-content" style="white-space: pre-wrap;">加载日志中...</pre>
    </div>
    <div style="padding: 10px 20px; border-top: 1px solid #eee; text-align: right;">
      <button class="btn btn-sm" onclick="clearLogs()">清空日志</button>
    </div>
  </div>
  
  <!-- 背景遮罩 (默认隐藏) -->
  <div id="modal-backdrop" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 999; display: none;"></div>
  
  <script>
    // 等待DOM加载完成
    document.addEventListener('DOMContentLoaded', () => {
      // 等待预加载脚本完成
      window.addEventListener('electron-preload-done', () => {
        console.log('Electron API已加载');
        loadAppInfo();
        setupUpdateListeners();
        setupPlatformSpecificUI();
      });
      
      // 如果预加载脚本已经加载完成
      if (window.electronAPI) {
        console.log('Electron API已就绪');
        loadAppInfo();
        setupUpdateListeners();
        setupPlatformSpecificUI();
      }
    });
    
    // 加载应用信息
    function loadAppInfo() {
      try {
        const appInfo = window.electronAPI.app.getInfo();
        
        // 更新各页面的应用信息
        document.getElementById('app-version').textContent = `版本: ${appInfo.version}`;
        document.getElementById('electron-version').textContent = ` | Electron: ${appInfo.electronVersion}`;
        
        document.getElementById('about-version').textContent = appInfo.version;
        document.getElementById('about-electron-version').textContent = appInfo.electronVersion;
        document.getElementById('about-platform').textContent = appInfo.platform;
        document.getElementById('about-arch').textContent = appInfo.arch;
      } catch (error) {
        console.error('加载应用信息失败:', error);
      }
    }
    
    // 设置更新监听器
    function setupUpdateListeners() {
      try {
        // 监听更新可用
        window.electronAPI.update.onUpdateAvailable((info) => {
          document.getElementById('update-status').innerHTML = '<span class="badge badge-success">发现新版本</span>';
        });
        
        // 监听更新不可用
        window.electronAPI.update.onUpdateNotAvailable(() => {
          document.getElementById('update-status').innerHTML = '<span class="badge badge-info">已是最新版本</span>';
          setTimeout(() => {
            document.getElementById('update-status').textContent = '等待检查...';
          }, 3000);
        });
        
        // 监听更新错误
        window.electronAPI.update.onUpdateError((error) => {
          document.getElementById('update-status').innerHTML = '<span class="badge badge-danger">更新失败</span>';
          console.error('更新错误:', error);
        });
        
        // 监听更新进度
        window.electronAPI.update.onUpdateProgress((progress) => {
          document.getElementById('update-progress-container').style.display = 'block';
          document.getElementById('update-progress-bar').style.width = `${progress}%`;
          document.getElementById('update-progress-bar').textContent = `${progress}%`;
        });
      } catch (error) {
        console.error('设置更新监听器失败:', error);
      }
    }
    
    // 设置平台特定UI
    function setupPlatformSpecificUI() {
      try {
        const appInfo = window.electronAPI.app.getInfo();
        
        // 在非Mac平台上隐藏自定义窗口控制按钮
        if (appInfo.platform !== 'darwin') {
          document.getElementById('window-controls').style.display = 'none';
        }
      } catch (error) {
        console.error('设置平台特定UI失败:', error);
      }
    }
    
    // 切换标签
    function switchTab(tabId) {
      // 隐藏所有标签内容
      const tabContents = document.querySelectorAll('.tab-content');
      tabContents.forEach(tab => {
        tab.classList.remove('active');
      });
      
      // 移除所有导航项的活动状态
      const navItems = document.querySelectorAll('.nav-item');
      navItems.forEach(item => {
        item.classList.remove('active');
      });
      
      // 显示选中的标签内容
      document.getElementById(tabId).classList.add('active');
      
      // 设置对应的导航项为活动状态
      const activeNavItem = document.querySelector(`.nav-item[onclick="switchTab('${tabId}')"]`);
      if (activeNavItem) {
        activeNavItem.classList.add('active');
      }
    }
    
    // 检查更新
    function checkForUpdates() {
      try {
        document.getElementById('update-status').innerHTML = '<span class="loading"></span> 检查中...';
        window.electronAPI.update.checkForUpdates();
      } catch (error) {
        console.error('检查更新失败:', error);
        document.getElementById('update-status').innerHTML = '<span class="badge badge-danger">检查失败</span>';
      }
    }
    
    // 显示通知
    function showNotification() {
      try {
        window.electronAPI.app.showNotification('通知示例', '这是一个通过Electron API发送的桌面通知');
      } catch (error) {
        console.error('发送通知失败:', error);
        alert('发送通知失败');
      }
    }
    
    // 显示应用信息
    function showAppInfo() {
      try {
        const appInfo = window.electronAPI.app.getInfo();
        const infoStr = `应用名称: ${appInfo.name}\n版本: ${appInfo.version}\nElectron版本: ${appInfo.electronVersion}\n平台: ${appInfo.platform}\n架构: ${appInfo.arch}\n开发模式: ${appInfo.isDev ? '是' : '否'}`;
        alert(infoStr);
      } catch (error) {
        console.error('显示应用信息失败:', error);
      }
    }
    
    // 窗口控制
    function windowControls(action) {
      try {
        window.electronAPI.window.control(action);
      } catch (error) {
        console.error('窗口控制失败:', error);
      }
    }
    
    // 构建Windows版本
    function buildForWindows() {
      showBuildNotImplemented();
    }
    
    // 构建macOS版本
    function buildForMacOS() {
      showBuildNotImplemented();
    }
    
    // 构建Linux版本
    function buildForLinux() {
      showBuildNotImplemented();
    }
    
    // 显示构建未实现提示
    function showBuildNotImplemented() {
      alert('此示例应用仅演示打包配置，不实际执行构建过程。请在命令行中使用 npm run build:* 命令执行实际构建。');
    }
    
    // 打开配置目录
    function openConfigDir() {
      try {
        alert('在实际应用中，这里会打开应用配置目录。');
      } catch (error) {
        console.error('打开配置目录失败:', error);
      }
    }
    
    // 查看日志
    async function viewLogs() {
      try {
        const logsDialog = document.getElementById('logs-dialog');
        const modalBackdrop = document.getElementById('modal-backdrop');
        const logsContent = document.getElementById('logs-content');
        
        // 显示加载中
        logsContent.textContent = '加载日志中...';
        
        // 显示对话框
        logsDialog.style.display = 'block';
        modalBackdrop.style.display = 'block';
        
        // 获取日志内容
        try {
          const logs = await window.electronAPI.app.getLogs();
          logsContent.textContent = logs || '暂无日志内容';
        } catch (error) {
          logsContent.textContent = `获取日志失败: ${error.message}`;
        }
      } catch (error) {
        console.error('查看日志失败:', error);
      }
    }
    
    // 关闭日志对话框
    function closeLogsDialog() {
      document.getElementById('logs-dialog').style.display = 'none';
      document.getElementById('modal-backdrop').style.display = 'none';
    }
    
    // 清空日志
    function clearLogs() {
      document.getElementById('logs-content').textContent = '日志已清空';
      alert('注意：此操作仅清空显示的日志，不会删除实际日志文件。');
    }
    
    // 打开外部文档
    function openExternalDocs() {
      try {
        window.electronAPI.app.openExternalLink('https://www.electronjs.org/docs');
      } catch (error) {
        console.error('打开外部链接失败:', error);
      }
    }
    
    // 错误处理
    window.onerror = function(message, source, lineno, colno, error) {
      console.error('全局错误:', { message, source, lineno, colno, error });
      return true; // 阻止默认事件处理
    };
    
    // Promise拒绝处理
    window.addEventListener('unhandledrejection', function(event) {
      console.error('未处理的Promise拒绝:', event.reason);
    });
  </script>
</body>
</html>